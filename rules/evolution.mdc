---
description: 与用户交互中发现可泛化的错误时，提炼「避免再犯」的规则，经用户确认后更新到本文档，实现自我改进闭环
alwaysApply: true
---

# Meta 自我改进规则（错误 → 规则 → 闭环）

在与用户交互过程中，若出现「自己犯错且错误可泛化」的情况，必须走**提炼规则 → 用户确认 → 更新规则**的闭环，避免同类错误再次发生。

## 何时触发

- **用户指出错误**：用户明确指正你的某次行为、实现或判断有误。
- **自行发现错误**：你在后续步骤或解释中意识到之前某步做错了（例如漏改调用、误解需求、违反既有规则等）。
- **错误具有可泛化性**：该错误不是一次性、项目特有的，而是「以后在类似场景下可能再犯」的通用性问题（例如：删参数只改定义不改调用、写 PRD 前未确认状态生命周期等）。

若错误仅为单次失误或项目特例，无需提炼规则，可仅道歉并修正当前任务。

## 必须执行的步骤

1. **明确错误与场景**
   用一两句话说明：在什么情境下、做了什么错误行为、正确做法应是什么。

2. **提炼为规则**
   将「避免再犯」写成一条可执行的规则表述（风格可参考本目录下其他 .mdc）：清晰、可操作、适用范围明确。

3. **与用户确认**
   将提炼出的规则及**建议写入的 .mdc 文件**（已有文件或新建）呈现给用户，并明确询问：
   **「是否同意把这条规则加入 ~/.cursor/rules 的 xxx.mdc？」**
   **未经用户确认，不得修改任何 .mdc 文件。**

4. **更新规则文档**
   用户同意后：
   - 若规则属于现有某 .mdc 的主题（如删除参数、Python 规范、规划检查等），则**追加或合并到该已有 .mdc** 的合适位置。
   - 若规则是新的类别，可新建一个 .mdc（命名清晰，如 `xxx-avoid.mdc`），并写入 `~/.cursor/rules`。
   - 更新时保持该文件已有的 frontmatter（`description`、`globs`、`alwaysApply`）和文档结构；新增内容与现有条款风格一致。

5. **简要确认闭环**
   更新完成后，简短告知用户已更新哪个文件、哪条规则，便于查阅或再改。

## 注意

- **不要过度泛化**：仅当能归纳出「在类似情境下应/不应如何做」时再提炼规则，避免把单次偏好当成通用规则。
- **不要重复**：若已有规则已覆盖同一要点，优先在已有规则下补充子条或示例，而不是另起一条重复规则。
- **归属清晰**：新规则尽量归入已有 .mdc；新建 .mdc 时说明理由（例如「与现有几类规则都不符，单独成类」）。

**口诀**：发现可泛化错误 → 提炼规则 → 与用户确认 → 更新对应 .mdc → 下次类似场景自动应用，形成闭环。
